BM42 Revenue<->metrics=realised_revenue:DESC&dimensions=null&fromTime=<from_yesterday_start>&toTime=<to_yesterday>&limit=100&offset=0&sendTotal=true___result[0].realised_revenue___select 	(to_char(a.yday_revenue,'99,99,99,99,999')) as yday_rev, 	trunc((a.yday_revenue - a.yday_minus_1_revenue)*100/nullif(a.yday_minus_1_revenue,0),1) as p1,  	a.yday_mobile_revenue/yday_revenue as yday_mobile_rev, 	(a.yday_mobile_revenue/yday_revenue) - (yday_minus_1_mobile_revenue/yday_mobile_revenue)/(a.yday_mobile_revenue/yday_revenue) as p4,  	(to_char(a.yday_order,'99,99,99,99,999')) as yday_order, 	trunc((a.yday_order - a.yday_minus_1_order)*100/nullif(a.yday_minus_1_order,0),1) as p2, 	(to_char(a.yday_revenue/a.yday_order,'99,99,99,99,999')) as yday_asp, 	trunc((a.yday_revenue/nullif(a.yday_order,0) - a.yday_minus_1_revenue/nullif(a.yday_minus_1_order,0))*100/(a.yday_minus_1_revenue/nullif(a.yday_minus_1_order,0)),1) as p3, 	 	to_char(a.mtd_revenue,'99,99,99,99,999') as mtd_revenue,  	to_char(a.month_minus_1_revenue,'99,99,99,99,999') as month_minus_1_revenue,  	to_char(a.month_minus_2_revenue,'99,99,99,99,999') as month_minus_2_revenue,  	to_char(a.month_minus_3_revenue,'99,99,99,99,999') as month_minus_3_revenue, 	 	to_char(a.yday_item_count,'99,99,99,99,999') as yday_item_count,  	to_char(a.mtd_item_count,'99,99,99,99,999') as mtd_item_count,  	to_char(a.month_minus_1_item_count,'99,99,99,99,999') as month_minus_1_item_count,  	to_char(a.month_minus_2_item_count,'99,99,99,99,999') as month_minus_2_item_count, 	to_char(a.month_minus_3_item_count,'99,99,99,99,999') as month_minus_3_item_count,	 	trunc((a.yday_item_count - a.yday_minus_1_item_count)*100/nullif(a.yday_minus_1_item_count,0),1) as p6,  	 	to_char(a.month_minus_1_revenue,'99,99,99,99,999') as month_minus_1_revenue,  	to_char(a.month_minus_2_revenue,'99,99,99,99,999') as month_minus_2_revenue,  	to_char(a.month_minus_3_revenue,'99,99,99,99,999') as month_minus_3_revenue, 	 	 	 	a.mtd_mobile_revenue/mtd_revenue as mtd_mobile_revenue,  	a.month_minus_1_mobile_revenue/month_minus_1_revenue as month_minus_1_mobile_revenue,  	a.month_minus_2_mobile_revenue/month_minus_2_revenue as month_minus_2_mobile_revenue,  	a.month_minus_3_mobile_revenue/month_minus_3_revenue as month_minus_3_mobile_revenue, 	a.mtd_order,  	a.month_minus_1_order,     month_minus_2_order,     month_minus_3_order, 	a.mtd_revenue/nullif(a.mtd_order,0) as mtd_asp,  	a.month_minus_1_revenue/nullif(a.month_minus_1_order,0) as month_minus_1_asp,  	a.month_minus_2_revenue/nullif(month_minus_2_order,0) as month_minus_2_asp,  	a.month_minus_3_revenue/nullif(month_minus_3_order,0) as month_minus_3_asp from 	 	(select  		sum(case when dt.day_diff = 1 then o.shipped_order_revenue_inc_cashback end) as yday_revenue, 		sum(case when dt.day_diff = 1 and o.order_channel like 'mobile%' then o.shipped_order_revenue_inc_cashback end) as yday_mobile_revenue, 		count(distinct (case when dt.day_diff = 1 then o.order_group_id end)) as yday_order, 		sum(case when dt.day_diff = 1 then o.shipped_item_count end) as yday_item_count, 	 		sum(case when dt.day_diff = 2 then o.shipped_order_revenue_inc_cashback end) as yday_minus_1_revenue, 		sum(case when dt.day_diff = 2 and o.order_channel like 'mobile%' then o.shipped_order_revenue_inc_cashback end) as yday_minus_1_mobile_revenue, 		count(distinct (case when dt.day_diff = 2 then o.order_group_id end)) as yday_minus_1_order, 		sum(case when dt.day_diff = 2 then o.shipped_item_count end) as yday_minus_1_item_count, 	 		 		sum(case when dt.month_to_date = 1 then o.shipped_item_count end) as mtd_item_count, 		sum(case when dt.month_diff = 1 then o.shipped_item_count end) as month_minus_1_item_count, 		sum(case when dt.month_diff = 2 then o.shipped_item_count end) as month_minus_2_item_count, 		sum(case when dt.month_diff = 3 then o.shipped_item_count end) as month_minus_3_item_count, 			 		sum(case when dt.month_to_date = 1 then o.shipped_order_revenue_inc_cashback end) as mtd_revenue, 		sum(case when dt.month_diff = 1 then o.shipped_order_revenue_inc_cashback end) as month_minus_1_revenue, 		sum(case when dt.month_diff = 2 then o.shipped_order_revenue_inc_cashback end) as month_minus_2_revenue, 		sum(case when dt.month_diff = 3 then o.shipped_order_revenue_inc_cashback end) as month_minus_3_revenue,  		sum(case when dt.month_to_date = 1 and o.order_channel like 'mobile%' then o.shipped_order_revenue_inc_cashback end) as mtd_mobile_revenue, 		sum(case when dt.month_diff = 1 and o.order_channel like 'mobile%' then o.shipped_order_revenue_inc_cashback end) as month_minus_1_mobile_revenue, 		sum(case when dt.month_diff = 2 and o.order_channel like 'mobile%' then o.shipped_order_revenue_inc_cashback end) as month_minus_2_mobile_revenue, 		sum(case when dt.month_diff = 3 and o.order_channel like 'mobile%' then o.shipped_order_revenue_inc_cashback end) as month_minus_3_mobile_revenue, 	 		count(distinct (case when dt.month_to_date = 1 then o.order_group_id end)) as mtd_order, 		count(distinct (case when dt.month_diff = 1 then o.order_group_id end)) as month_minus_1_order, 		count(distinct (case when dt.month_diff = 2 then o.order_group_id end)) as month_minus_2_order, 		count(distinct (case when dt.month_diff = 3 then o.order_group_id end)) as month_minus_3_order 	 	from  		fact_order o, dim_date dt 	where  		dt.month_diff<=3  		and store_id=1 		and o.order_created_date = dt.full_date  		and (o.is_shipped = 1 or o.is_realised=1)         and o.order_created_date >= to_char(dateadd(month,-3,convert_timezone('Asia/Calcutta',getdate())),'YYYYMM01')) a                           